<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Tab Countdown Timer</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="favicon.png" type="image/x-icon">
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center justify-center p-4">
<div class="max-w-md w-full text-center space-y-6">
    <h1 class="text-3xl font-bold">Tab Countdown Timer</h1>

    <!-- Input & Buttons -->
    <div class="flex flex-col items-center sm:flex-row sm:justify-center sm:space-x-4 space-y-3 sm:space-y-0">
        <div class="flex items-center space-x-2">
            <label for="inputMinutes" class="font-medium">Minutes:</label>
            <input
                    type="number"
                    id="inputMinutes"
                    value="1"
                    min="1"
                    class="w-20 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
        </div>

        <button
                onclick="startTimer()"
                class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"
        >
            Start
        </button>

        <button
                onclick="pauseTimer()"
                class="px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400"
        >
            Pause
        </button>

        <button
                onclick="resetTimer()"
                class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"
        >
            Reset
        </button>
    </div>

    <!-- Time Display -->
    <h2 id="countdownDisplay" class="text-4xl font-bold text-gray-700">00:00</h2>

    <!-- Progress Bar -->
    <div class="w-full bg-gray-200 rounded h-4">
        <div id="progressBar" class="bg-blue-600 h-4 rounded" style="width:0%"></div>
    </div>
</div>

<script>
    let countdownInterval;
    let blinkInterval;
    let totalSeconds;
    let remainingSeconds;

    function startTimer() {
        // If there's no "remainingSeconds" set or we've reset, read from input again
        if (!remainingSeconds) {
            const minutes = parseInt(document.getElementById("inputMinutes").value, 10) || 1;
            totalSeconds = minutes * 60;
            remainingSeconds = totalSeconds;
        }

        // Immediately update display
        updateDisplay(remainingSeconds);

        // Clear any existing intervals
        clearInterval(countdownInterval);
        clearInterval(blinkInterval); // Stop any existing "Time's up!" blink
        blinkInterval = null;

        countdownInterval = setInterval(() => {
            remainingSeconds--;

            if (remainingSeconds < 0) {
                clearInterval(countdownInterval);
                // Start blinking "Time's up!"
                blinkTimesUp();
                remainingSeconds = 0;
            } else {
                updateDisplay(remainingSeconds);
            }
        }, 1000);
    }

    function pauseTimer() {
        clearInterval(countdownInterval);
    }

    function resetTimer() {
        clearInterval(countdownInterval);
        clearInterval(blinkInterval);
        blinkInterval = null;
        remainingSeconds = 0;
        updateDisplay(0);
        updateProgressBar(0);
    }

    function updateDisplay(seconds) {
        const m = Math.floor(seconds / 60);
        const s = seconds % 60;
        const timeStr = String(m).padStart(2, '0') + ":" + String(s).padStart(2, '0');

        // Update page content
        document.getElementById("countdownDisplay").textContent = timeStr;
        // Update browser tab
        document.title = timeStr + " - Countdown Timer";

        // Update progress bar
        const progressPercent = totalSeconds
            ? (seconds / totalSeconds) * 100
            : 0;
        updateProgressBar(progressPercent);
    }

    function updateProgressBar(percentage) {
        document.getElementById("progressBar").style.width = percentage + "%";
    }

    function blinkTimesUp() {
        let show = true;
        blinkInterval = setInterval(() => {
            if (show) {
                document.getElementById("countdownDisplay").textContent = "Time's up!";
                document.title = "Time's up!";
            } else {
                //document.getElementById("countdownDisplay").textContent = "";
                document.title = "Tab Countdown Timer";
            }
            show = !show;
        }, 1000); // Blink every 500ms
    }
</script>
</body>
</html>
